---
title: "cluster-bleaching"
author: "Trevor Tivey"
date: "9/21/2021"
output: html_document
---
# Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(dplyr)
library(data.table)
library(tidyr)
library(splitstackshape)
library(ggplot2)
library(Hmisc)
library(tidyverse)
library(rstatix)
library(ggpubr)
library(car)
library(multcomp)

table_glht <- function(x) {
  pq <- summary(x)$test
  mtests <- cbind(pq$coefficients, pq$sigma, pq$tstat, pq$pvalues)
  error <- attr(pq$pvalues, "error")
  pname <- switch(x$alternativ, less = paste("Pr(<", ifelse(x$df ==0, "z", "t"), ")", sep = ""), 
  greater = paste("Pr(>", ifelse(x$df == 0, "z", "t"), ")", sep = ""), two.sided = paste("Pr(>|",ifelse(x$df == 0, "z", "t"), "|)", sep = ""))
  colnames(mtests) <- c("Estimate", "Std. Error", ifelse(x$df ==0, "z value", "t value"), pname)
  return(mtests)}
```

# Set appropriate breakpoints for cell cluster size discrimination
```{r mfsingle, include=FALSE, results=}


breaks1 = c(0.001, 0.2001, 0.4001, 0.5001, 0.6001, 0.7001, 0.8001, 1.001, 1.251, 1.401, 1.801, 2.001, 2.201, 2.301, 2.401, 2.601, 2.801, 3.001, 3.301)
breaks2 = seq(3.501,1000.001,0.5)
breaks3 = seq(3.501,999.501,0.5)
breaks = c(breaks1,breaks2)
breaks_names = c(breaks1,breaks3)
```

# Create cluster lists
```{r mfsingle, include=FALSE, results=}

# Set directory
setwd("./all-3dobj-counts/")

# List txt file outputs generated by ImageJ2 3D Object Counter
clusterlist = list.files(pattern = ".txt")

# Loop through files to select sample name, object area, cut sizes according to breaks, and write output to new file.


## note, reading tab separated txt files as csv input.
## e.g. sample_file <-read.csv("Movie-11-Image Export-443merge.txt", header = T, sep = "\t")

for(i in 1:length(clusterlist)) {
  sample_file <- read.csv(clusterlist[i], header = T, sep = "\t")
  sample_name = clusterlist[i]
  if(nrow(sample_file) > 1) {
    sample_file$X.1 <- seq.int(nrow(sample_file))
    sample_file2 <- sample_file %>% dplyr::select(1, 3)
    sample_file2$clustersize <- sample_file2$Surface..pixel.2./100
    sample_file2$name <- sample_name
    
    print(sample_file2)
    
    clustersize.cut = cut(sample_file2$clustersize, breaks, right=FALSE)

    clustertable <- table(clustersize.cut)
    clusterdf <- data.frame(clustertable)

    
    clusterdft <- t(clusterdf)
    clust_size <- breaks_names
    colnames(clusterdft) <- clust_size
    
    sample_image <- c(sample_name,sample_name)
    
    sample_file_clust_hist <- cbind(sample_image,clusterdft)
    
    setwd("../output-3dobj-counts-with-zeros/")
    write.csv(sample_file2, clusterlist[i])
    setwd("../output-hists-with-zeros/")
    write.csv(sample_file_clust_hist, clusterlist[i])
    setwd("../all-3dobj-counts/")

  } 
  # If input file has no objects, placeholder file created.
  else {
    X.1 <- c(1)
    Surface..pixel.2. <- c(0)
    clustersize <- c(0)
    name <- c(sample_name)
    sample_file2 <- data.frame(X.1,Surface..pixel.2.,clustersize,name)
    
    print(sample_file2)
    
    clustersize.cut = cut(sample_file2$clustersize, breaks, right=FALSE)
    #print(clustersize.cut)
    clustertable <- table(clustersize.cut)
    clusterdf <- data.frame(clustertable)
    # print(clusterdf)
    
    clusterdft <- t(clusterdf)
    clust_size <- breaks_names
    colnames(clusterdft) <- clust_size
    
    sample_image <- c(sample_name,sample_name)
    
    sample_file_clust_hist <- cbind(sample_image,clusterdft)

    
    setwd("../output-3dobj-counts-with-zeros/")
    write.csv(sample_file2, clusterlist[i])
    setwd("../output-hists-with-zeros/")
    write.csv(sample_file_clust_hist, clusterlist[i])
    setwd("../all-3dobj-counts/")
    
  }
}

```

# Double-check break names is same as cluster tables
```{r}
length(breaks_names)
length(clustertable)
```

# Summarize into summary files with and without including zeros
```{r}

setwd("./output-3dobj-counts-with-zeros/")
objcount_w_zeros.list = list.files(pattern = ".txt")
ocount_w_zeros.1 = lapply(objcount_w_zeros.list, read.csv, header=T, stringsAsFactors = F)
ocount_w_zeros.2 <- rbindlist(ocount_w_zeros.1, fill = T)


setwd("../output-hists-with-zeros/")
hist_w_zeros.list = list.files(pattern = ".txt")
hist_w_zeros.1 = lapply(hist_w_zeros.list, read.csv, header=T, stringsAsFactors = F)
hist_w_zeros.2 <- rbindlist(hist_w_zeros.1, fill = T)
hist_w_zeros.3 <- subset(hist_w_zeros.2, X == "Freq")
colnames(hist_w_zeros.3) <- substring(colnames(hist_w_zeros.3), 2)
colnames(hist_w_zeros.3)[1] <- "category"
colnames(hist_w_zeros.3)[2] <- "sample_name"
```

# Write summary files
```{r}
numeric_column_id = 3:2014 # column ids to change to numeric
hist_w_zeros.4 <- mutate_each(hist_w_zeros.3, funs(as.numeric), numeric_column_id)
hist_w_zeros.4$greater_than_50 <- rowSums(hist_w_zeros.4[,116:1003])
hist_w_zeros.5 <- hist_w_zeros.4[,2:115]
hist_w_zeros.6 <- cbind(hist_w_zeros.5,hist_w_zeros.4$greater_than_50)

setwd("./summary csv/")

write.csv(hist_w_zeros.4, "hist-0-long.csv")
write.csv(hist_w_zeros.6, "hist-0-short.csv")
write.csv(ocount_w_zeros.2, "obj_count_combined_w0.csv")
```



## summarize obj_count_combined to get total cluster number, total cluster volume, total cluster size, by name
```{r}
setwd("./summary csv/")

### link both csvs

clusts_bleach <- read.csv("finalcluster2020.csv", header = T)
# grouping cluster groups
clusts_plus_bleach <- clusts_bleach


clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xone = dplyr::select(., X0.001:X0.4001) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xtwo = dplyr::select(., X0.5001:X1.001) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xthree = dplyr::select(., X1.251:X1.801) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xfour = dplyr::select(., X2.001:X2.801) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xthreefour = dplyr::select(., X1.251:X2.801) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xfive = dplyr::select(., X3.001:X3.301) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X6to9 = dplyr::select(., X3.501:X5.001) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X5to10 = dplyr::select(., X3.001:X5.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xover10 = dplyr::select(., X6.001:X999.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X10to15 = dplyr::select(., X5.501:X8.001) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xover15 = dplyr::select(., X8.501:X999.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X15to50 = dplyr::select(., X8.501:X25.001) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(Xover50 = dplyr::select(., X25.501:X999.501) %>% rowSums(na.rm = TRUE))
```


# Counting total clusters
```{r}
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_50_100 = dplyr::select(., X25.501:X50.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_100_200 = dplyr::select(., X51.001:X100.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_200_300 = dplyr::select(., X101.001:X150.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_300_400 = dplyr::select(., X151.001:X200.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_400_500 = dplyr::select(., X201.001:X250.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_500_600 = dplyr::select(., X251.001:X300.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_600_700 = dplyr::select(., X301.001:X350.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_700_800 = dplyr::select(., X351.001:X400.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_800_900 = dplyr::select(., X401.001:X450.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_900_1000 = dplyr::select(., X451.001:X500.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1000_1100 = dplyr::select(., X501.001:X550.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1100_1200 = dplyr::select(., X551.001:X600.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1200_1300 = dplyr::select(., X601.001:X650.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1300_1400 = dplyr::select(., X651.001:X700.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1400_1500 = dplyr::select(., X701.001:X750.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1500_1600 = dplyr::select(., X751.001:X800.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1600_1700 = dplyr::select(., X801.001:X850.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1700_1800 = dplyr::select(., X851.001:X900.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1800_1900 = dplyr::select(., X901.001:X950.501) %>% rowSums(na.rm = TRUE))
clusts_plus_bleach <- clusts_plus_bleach %>%
    mutate(X_1900_2000 = dplyr::select(., X951.001:X999.501) %>% rowSums(na.rm = TRUE))
```


# Counting total cells
```{r}
clusts_plus_bleach$hist_sum_one <- clusts_plus_bleach$Xone
clusts_plus_bleach$hist_sum_two <- 2*clusts_plus_bleach$Xtwo
clusts_plus_bleach$hist_sum_three <- 3*clusts_plus_bleach$Xthree
clusts_plus_bleach$hist_sum_four <- 4*clusts_plus_bleach$Xfour
clusts_plus_bleach$hist_sum_five <- 5*clusts_plus_bleach$Xfive
clusts_plus_bleach$hist_sum_6to9 <- 6*clusts_plus_bleach$X3.501 +
  7*clusts_plus_bleach$X4.001 +
  8*clusts_plus_bleach$X4.501 +
  9*clusts_plus_bleach$X5.001
clusts_plus_bleach$hist_sum_10to15 <- 10*clusts_plus_bleach$X5.501 +
  11*clusts_plus_bleach$X6.001 +
  12*clusts_plus_bleach$X6.501 +
  13*clusts_plus_bleach$X7.001 +
  14*clusts_plus_bleach$X7.501 +
  15*clusts_plus_bleach$X8.001
clusts_plus_bleach$hist_sum_over15 <- 16*clusts_plus_bleach$X8.501 +
  17*clusts_plus_bleach$X9.001 +
  18*clusts_plus_bleach$X9.501 +
  19*clusts_plus_bleach$X10.001 +
  20*clusts_plus_bleach$X10.501 +
  21*clusts_plus_bleach$X11.001 +
  22*clusts_plus_bleach$X11.501 +
  23*clusts_plus_bleach$X12.001 +
  24*clusts_plus_bleach$X12.501 +
  25*clusts_plus_bleach$X13.001 +
  26*clusts_plus_bleach$X13.501 +
  27*clusts_plus_bleach$X14.001 +
  28*clusts_plus_bleach$X14.501 +
  29*clusts_plus_bleach$X15.001 +
  30*clusts_plus_bleach$X15.501 +
  31*clusts_plus_bleach$X16.001 +
  32*clusts_plus_bleach$X16.501 +
  33*clusts_plus_bleach$X17.001 +
  34*clusts_plus_bleach$X17.501 +
  35*clusts_plus_bleach$X18.001 +
  36*clusts_plus_bleach$X18.501 +
  37*clusts_plus_bleach$X19.001 +
  38*clusts_plus_bleach$X19.501 +
  39*clusts_plus_bleach$X20.001 +
  40*clusts_plus_bleach$X20.501 +
  41*clusts_plus_bleach$X21.001 +
  42*clusts_plus_bleach$X21.501 +
  43*clusts_plus_bleach$X22.001 +
  44*clusts_plus_bleach$X22.501 +
  45*clusts_plus_bleach$X23.001 +
  46*clusts_plus_bleach$X23.501 +
  47*clusts_plus_bleach$X24.001 +
  48*clusts_plus_bleach$X24.501 +
  49*clusts_plus_bleach$X25.001 +
  75*clusts_plus_bleach$X_50_100 +
  150*clusts_plus_bleach$X_100_200 +
  250*clusts_plus_bleach$X_200_300 +
  350*clusts_plus_bleach$X_300_400 +
  450*clusts_plus_bleach$X_400_500 +
  550*clusts_plus_bleach$X_500_600 +
  650*clusts_plus_bleach$X_600_700 +
  750*clusts_plus_bleach$X_700_800 +
  850*clusts_plus_bleach$X_800_900 +
  950*clusts_plus_bleach$X_900_1000 +
  1050*clusts_plus_bleach$X_1000_1100 +
  1150*clusts_plus_bleach$X_1100_1200 +
  1250*clusts_plus_bleach$X_1200_1300 +
  1350*clusts_plus_bleach$X_1300_1400 +
  1450*clusts_plus_bleach$X_1400_1500 +
  1550*clusts_plus_bleach$X_1500_1600 +
  1650*clusts_plus_bleach$X_1600_1700 +
  1750*clusts_plus_bleach$X_1700_1800 +
  1850*clusts_plus_bleach$X_1800_1900 +
  1950*clusts_plus_bleach$X_1900_2000



clusts_plus_bleach$hist_sum <- 
  clusts_plus_bleach$Xone + 
  2*clusts_plus_bleach$Xtwo +
  3*clusts_plus_bleach$Xthree + 
  4*clusts_plus_bleach$Xfour +
  5*clusts_plus_bleach$Xfive +
  6*clusts_plus_bleach$X3.501 +
  7*clusts_plus_bleach$X4.001 +
  8*clusts_plus_bleach$X4.501 +
  9*clusts_plus_bleach$X5.001 +
  10*clusts_plus_bleach$X5.501 +
  11*clusts_plus_bleach$X6.001 +
  12*clusts_plus_bleach$X6.501 +
  13*clusts_plus_bleach$X7.001 +
  14*clusts_plus_bleach$X7.501 +
  15*clusts_plus_bleach$X8.001 +
  16*clusts_plus_bleach$X8.501 +
  17*clusts_plus_bleach$X9.001 +
  18*clusts_plus_bleach$X9.501 +
  19*clusts_plus_bleach$X10.001 +
  20*clusts_plus_bleach$X10.501 +
  21*clusts_plus_bleach$X11.001 +
  22*clusts_plus_bleach$X11.501 +
  23*clusts_plus_bleach$X12.001 +
  24*clusts_plus_bleach$X12.501 +
  25*clusts_plus_bleach$X13.001 +
  26*clusts_plus_bleach$X13.501 +
  27*clusts_plus_bleach$X14.001 +
  28*clusts_plus_bleach$X14.501 +
  29*clusts_plus_bleach$X15.001 +
  30*clusts_plus_bleach$X15.501 +
  31*clusts_plus_bleach$X16.001 +
  32*clusts_plus_bleach$X16.501 +
  33*clusts_plus_bleach$X17.001 +
  34*clusts_plus_bleach$X17.501 +
  35*clusts_plus_bleach$X18.001 +
  36*clusts_plus_bleach$X18.501 +
  37*clusts_plus_bleach$X19.001 +
  38*clusts_plus_bleach$X19.501 +
  39*clusts_plus_bleach$X20.001 +
  40*clusts_plus_bleach$X20.501 +
  41*clusts_plus_bleach$X21.001 +
  42*clusts_plus_bleach$X21.501 +
  43*clusts_plus_bleach$X22.001 +
  44*clusts_plus_bleach$X22.501 +
  45*clusts_plus_bleach$X23.001 +
  46*clusts_plus_bleach$X23.501 +
  47*clusts_plus_bleach$X24.001 +
  48*clusts_plus_bleach$X24.501 +
  49*clusts_plus_bleach$X25.001 +
  75*clusts_plus_bleach$X_50_100 +
  150*clusts_plus_bleach$X_100_200 +
  250*clusts_plus_bleach$X_200_300 +
  350*clusts_plus_bleach$X_300_400 +
  450*clusts_plus_bleach$X_400_500 +
  550*clusts_plus_bleach$X_500_600 +
  650*clusts_plus_bleach$X_600_700 +
  750*clusts_plus_bleach$X_700_800 +
  850*clusts_plus_bleach$X_800_900 +
  950*clusts_plus_bleach$X_900_1000 +
  1050*clusts_plus_bleach$X_1000_1100 +
  1150*clusts_plus_bleach$X_1100_1200 +
  1250*clusts_plus_bleach$X_1200_1300 +
  1350*clusts_plus_bleach$X_1300_1400 +
  1450*clusts_plus_bleach$X_1400_1500 +
  1550*clusts_plus_bleach$X_1500_1600 +
  1650*clusts_plus_bleach$X_1600_1700 +
  1750*clusts_plus_bleach$X_1700_1800 +
  1850*clusts_plus_bleach$X_1800_1900 +
  1950*clusts_plus_bleach$X_1900_2000

```

# Total cluster count
```{r}
clusts_plus_bleach$hist_count <- 
  clusts_plus_bleach$Xone + 
  clusts_plus_bleach$Xtwo +
  clusts_plus_bleach$Xthree + 
  clusts_plus_bleach$Xfour +
  clusts_plus_bleach$Xfive +
  clusts_plus_bleach$X3.501 +
  clusts_plus_bleach$X4.001 +
  clusts_plus_bleach$X4.501 +
  clusts_plus_bleach$X5.001 +
  clusts_plus_bleach$X5.501 +
  clusts_plus_bleach$X6.001 +
  clusts_plus_bleach$X6.501 +
  clusts_plus_bleach$X7.001 +
  clusts_plus_bleach$X7.501 +
  clusts_plus_bleach$X8.001 +
  clusts_plus_bleach$X8.501 +
  clusts_plus_bleach$X9.001 +
  clusts_plus_bleach$X9.501 +
  clusts_plus_bleach$X10.001 +
  clusts_plus_bleach$X10.501 +
  clusts_plus_bleach$X11.001 +
  clusts_plus_bleach$X11.501 +
  clusts_plus_bleach$X12.001 +
  clusts_plus_bleach$X12.501 +
  clusts_plus_bleach$X13.001 +
  clusts_plus_bleach$X13.501 +
  clusts_plus_bleach$X14.001 +
  clusts_plus_bleach$X14.501 +
  clusts_plus_bleach$X15.001 +
  clusts_plus_bleach$X15.501 +
  clusts_plus_bleach$X16.001 +
  clusts_plus_bleach$X16.501 +
  clusts_plus_bleach$X17.001 +
  clusts_plus_bleach$X17.501 +
  clusts_plus_bleach$X18.001 +
  clusts_plus_bleach$X18.501 +
  clusts_plus_bleach$X19.001 +
  clusts_plus_bleach$X19.501 +
  clusts_plus_bleach$X20.001 +
  clusts_plus_bleach$X20.501 +
  clusts_plus_bleach$X21.001 +
  clusts_plus_bleach$X21.501 +
  clusts_plus_bleach$X22.001 +
  clusts_plus_bleach$X22.501 +
  clusts_plus_bleach$X23.001 +
  clusts_plus_bleach$X23.501 +
  clusts_plus_bleach$X24.001 +
  clusts_plus_bleach$X24.501 +
  clusts_plus_bleach$X25.001 +
  clusts_plus_bleach$X_50_100 +
  clusts_plus_bleach$X_100_200 +
  clusts_plus_bleach$X_200_300 +
  clusts_plus_bleach$X_300_400 +
  clusts_plus_bleach$X_400_500 +
  clusts_plus_bleach$X_500_600 +
  clusts_plus_bleach$X_600_700 +
  clusts_plus_bleach$X_700_800 +
  clusts_plus_bleach$X_800_900 +
  clusts_plus_bleach$X_900_1000 +
  clusts_plus_bleach$X_1000_1100 +
  clusts_plus_bleach$X_1100_1200 +
  clusts_plus_bleach$X_1200_1300 +
  clusts_plus_bleach$X_1300_1400 +
  clusts_plus_bleach$X_1400_1500 +
  clusts_plus_bleach$X_1500_1600 +
  clusts_plus_bleach$X_1600_1700 +
  clusts_plus_bleach$X_1700_1800 +
  clusts_plus_bleach$X_1800_1900 +
  clusts_plus_bleach$X_1900_2000
```

# Subset dataset
```{r}
clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 9785)
clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 9793)

clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 9879)
clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 9905)

clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 9562)
clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 9987)
clusts_plus_bleach <- subset(clusts_plus_bleach, sample != 7705)
```





```{r}
library(multcomp)
library(car)
library(emmeans)
library(lme4)
```

```{r}
clusts_plus_bleach$int <- interaction(clusts_plus_bleach$temperature, clusts_plus_bleach$day)
clusts_plus_bleach$int <- as.factor(clusts_plus_bleach$int)

clusts_plus_bleach_day <- subset(clusts_plus_bleach, day %in% c(4,7,9,11,14,16,18,21,25,31))
clusts_plus_bleach_A <- subset(clusts_plus_bleach_day, group == "A")
clusts_plus_bleach_B <- subset(clusts_plus_bleach_day, group == "B")
clusts_plus_bleach_D <- subset(clusts_plus_bleach_day, group == "C")
```

# B stats
```{r}
clusts_plus_bleach_B$sqone <- (clusts_plus_bleach_B$Xone)^(1/4)

mod.b <- lm(sqone ~ int, data = clusts_plus_bleach_B)
summary(mod.b)
#vif(onelm)
#assess normality
b.res = residuals(mod.b)
summary(b.res)
qqPlot(b.res)
hist(b.res)
boxplot(b.res)
shapiro.test(b.res)


#assess homoscedasticity
plot(fitted(mod.b),b.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b),b.res));

Anova(mod.b,test.statistic = 'F')

sumb <- summary(glht(mod.b, linfct=mcp(int ="Tukey")))

sumbt <- table_glht(sumb)

write.csv(sumbt, "tukey_b_1.csv")
```

```{r}
clusts_plus_bleach_B$sqtwo <- log(1+clusts_plus_bleach_B$Xtwo)^(1/1)

mod.b2 <- lm(sqtwo ~ int, data = clusts_plus_bleach_B)
summary(mod.b2)
#vif(onelm)
#assess normality
b2.res = residuals(mod.b2)
summary(b2.res)
qqPlot(b2.res)
hist(b2.res)
boxplot(b2.res)
shapiro.test(b2.res)
#some of the points at the end do fall out of the 95% confidence interval, but it isn't too many. the majority fall withing the bounds

#assess homoscedasticity
plot(fitted(mod.b2),b2.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b2),b2.res));

Anova(mod.b2,test.statistic = 'F')

sumb2 <- glht(mod.b2, linfct=mcp(int ="Tukey"))

sumbt2 <- table_glht(sumb2)

write.csv(sumbt2, "tukey_b_2.csv")
```

```{r}
clusts_plus_bleach_B$sqthree <- log(1+clusts_plus_bleach_B$Xthree)^(1/1)

mod.b3 <- lm(sqthree ~ int, data = clusts_plus_bleach_B)
summary(mod.b3)
#vif(onelm)
#assess normality
b3.res = residuals(mod.b3)
summary(b3.res)
qqPlot(b3.res)
hist(b3.res)
boxplot(b3.res)
shapiro.test(b3.res)

#assess homoscedasticity
plot(fitted(mod.b3),b3.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b3),b3.res));

Anova(mod.b3,test.statistic = 'F')

sumb3 <- glht(mod.b3, linfct=mcp(int ="Tukey"))


sumbt3 <- table_glht(sumb3)

write.csv(sumbt3, "tukey_b_3.csv")
```


```{r}
clusts_plus_bleach_B$sqfour <- log(1+clusts_plus_bleach_B$Xfour)^(1/1)

mod.b4 <- lm(sqfour ~ int, data = clusts_plus_bleach_B)
summary(mod.b4)
#vif(onelm)
#assess normality
b4.res = residuals(mod.b4)
summary(b4.res)
qqPlot(b4.res)
hist(b4.res)
boxplot(b4.res)
shapiro.test(b4.res)

#assess homoscedasticity
plot(fitted(mod.b4),b4.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b4),b4.res));

Anova(mod.b4,test.statistic = 'F')

sumb4 <- glht(mod.b4, linfct=mcp(int ="Tukey"))

sumbt4 <- table_glht(sumb4)

write.csv(sumbt4, "tukey_b_4.csv")
```


```{r}
clusts_plus_bleach_B$sqthreefour <- log(1+clusts_plus_bleach_B$Xthreefour)^(1/1)

mod.b34 <- lm(sqthreefour ~ int, data = clusts_plus_bleach_B)
summary(mod.b34)
#vif(onelm)
#assess normality
b34.res = residuals(mod.b34)
summary(b34.res)
qqPlot(b34.res)
hist(b34.res)
boxplot(b34.res)
shapiro.test(b34.res)

#assess homoscedasticity
plot(fitted(mod.b34),b34.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b34),b34.res));

Anova(mod.b34,test.statistic = 'F')

sumb34 <- glht(mod.b34, linfct=mcp(int ="Tukey"))

sumbt34 <- table_glht(sumb34)

write.csv(sumbt34, "tukey_b_34.csv")
```



# five
```{r}
clusts_plus_bleach_B$sqfive <- log(1+clusts_plus_bleach_B$Xfive)^(1/1)

mod.b5 <- lm(sqfive ~ int, data = clusts_plus_bleach_B)
summary(mod.b5)
#vif(onelm)
#assess normality
b5.res = residuals(mod.b5)
summary(b5.res)
qqPlot(b5.res)
hist(b5.res)
boxplot(b5.res)
shapiro.test(b5.res)

#assess homoscedasticity
plot(fitted(mod.b5),b5.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b5),b5.res));

Anova(mod.b5,test.statistic = 'F')

sumb5 <- glht(mod.b5, linfct=mcp(int ="Tukey"))

sumbt5 <- table_glht(sumb5)

write.csv(sumbt5, "tukey_b_5.csv")
```

# five to ten
```{r}
clusts_plus_bleach_B$sq5to10 <- log(1+clusts_plus_bleach_B$X5to10)^(1/1)

mod.b510 <- lm(sq5to10 ~ int, data = clusts_plus_bleach_B)
summary(mod.b510)
#vif(onelm)
#assess normality
b510.res = residuals(mod.b510)
summary(b510.res)
qqPlot(b510.res)
hist(b510.res)
boxplot(b510.res)
shapiro.test(b510.res)

#assess homoscedasticity
plot(fitted(mod.b510),b510.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b510),b510.res));

Anova(mod.b510,test.statistic = 'F')

sumb510 <- glht(mod.b510, linfct=mcp(int ="Tukey"))

sumbt510 <- table_glht(sumb510)

write.csv(sumbt510, "tukey_b_510.csv")
```


```{r}
clusts_plus_bleach_B$sq6to9 <- log(1+clusts_plus_bleach_B$X6to9)^(1/1)

mod.b6to9 <- lm(sq6to9~ int, data = clusts_plus_bleach_B)
summary(mod.b6to9)
#vif(onelm)
#assess normality
b6to9.res = residuals(mod.b6to9)
summary(b6to9.res)
qqPlot(b6to9.res)
hist(b6to9.res)
boxplot(b6to9.res)
shapiro.test(b6to9.res)

#assess homoscedasticity
plot(fitted(mod.b6to9),b6to9.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b6to9),b6to9.res));

Anova(mod.b6to9,test.statistic = 'F')

sumb6to9 <- glht(mod.b6to9, linfct=mcp(int ="Tukey"))

sumbt6to9 <- table_glht(sumb6to9)

write.csv(sumbt6to9, "tukey_b_6to9.csv")
```

# 10 to 15
```{r}
clusts_plus_bleach_B$sq10to15 <- log(1+clusts_plus_bleach_B$X10to15)^(1/1)

mod.b10to15 <- lm(sq10to15~ int, data = clusts_plus_bleach_B)
summary(mod.b10to15)
#vif(onelm)
#assess normality
b10to15.res = residuals(mod.b10to15)
summary(b10to15.res)
qqPlot(b10to15.res)
hist(b10to15.res)
boxplot(b10to15.res)
shapiro.test(b10to15.res)

#assess homoscedasticity
plot(fitted(mod.b10to15),b10to15.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.b10to15),b10to15.res));

Anova(mod.b10to15,test.statistic = 'F')

sumb10to15 <- glht(mod.b10to15, linfct=mcp(int ="Tukey"))

sumbt10to15 <- table_glht(sumb10to15)

write.csv(sumbt10to15, "tukey_b_10to15.csv")
```



# over 10
```{r}
clusts_plus_bleach_B$sqover10 <- log(1+clusts_plus_bleach_B$Xover10)^(1/1)

mod.bover10 <- lm(sqover10 ~ int, data = clusts_plus_bleach_B)
summary(mod.bover10)
#vif(onelm)
#assess normality
bover10.res = residuals(mod.bover10)
summary(bover10.res)
qqPlot(bover10.res)
hist(bover10.res)
boxplot(bover10.res)
shapiro.test(bover10.res)

#assess homoscedasticity
plot(fitted(mod.bover10),bover10.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.bover10),bover10.res));

Anova(mod.bover10,test.statistic = 'F')

sumbover10 <- glht(mod.bover10, linfct=mcp(int ="Tukey"))

sumbtover10 <- table_glht(sumbover10)

write.csv(sumbtover10, "tukey_b_over10.csv")
```














# cell sum
```{r}
clusts_plus_bleach_B$sqhistsum <- log(1+clusts_plus_bleach_B$hist_sum)^(1/1)

mod.histsumb <- lm(sqhistsum~ int, data = clusts_plus_bleach_B)
summary(mod.histsumb)
#vif(onelm)
#assess normality
histsumb.res = residuals(mod.histsumb)
summary(histsumb.res)
qqPlot(histsumb.res)
hist(histsumb.res)
boxplot(histsumb.res)
shapiro.test(histsumb.res)

#assess homoscedasticity
plot(fitted(mod.histsumb),histsumb.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.histsumb),histsumb.res));

Anova(mod.histsumb,test.statistic = 'F')

sumbhist <- glht(mod.histsumb, linfct=mcp(int ="Tukey"))

sumbthist <- table_glht(sumbhist)

write.csv(sumbthist, "tukey_b_histsum.csv")
```

# cluster sum
```{r}
clusts_plus_bleach_B$sqhistcount <- log(1+clusts_plus_bleach_B$hist_count)^(1/1)

mod.histcountb <- lm(sqhistcount ~ int, data = clusts_plus_bleach_B)
summary(mod.histcountb)
#vif(onelm)
#assess normality
histcountb.res = residuals(mod.histcountb)
summary(histcountb.res)
qqPlot(histcountb.res)
hist(histcountb.res)
boxplot(histcountb.res)
shapiro.test(histcountb.res)

#assess homoscedasticity
plot(fitted(mod.histcountb),histcountb.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.histcountb),histcountb.res));

Anova(mod.histcountb,test.statistic = 'F')

sumbhistcount <- glht(mod.histcountb, linfct=mcp(int ="Tukey"))

sumbthistcount <- table_glht(sumbhistcount)

write.csv(sumbthistcount, "tukey_b_histcount.csv")
```








# A stats


```{r}
clusts_plus_bleach_A$sqone <- log(1+clusts_plus_bleach_A$Xone)^(1/1)

mod.a1 <- lm(sqone ~ int, data = clusts_plus_bleach_A)
summary(mod.a1)
#vif(onelm)
#assess normality
a1.res = residuals(mod.a1)
summary(a1.res)
qqPlot(a1.res)
hist(a1.res)
boxplot(a1.res)
shapiro.test(a1.res)

#assess homoscedasticity
plot(fitted(mod.a1),a1.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a1),a1.res));

Anova(mod.a1,test.statistic = 'F')

suma1 <- glht(mod.a1, linfct=mcp(int ="Tukey"))


suma1t <- table_glht(suma1)

write.csv(suma1t, "tukey_a_one_only.csv")
```

```{r}
clusts_plus_bleach_A$sqtwo <- log(1+clusts_plus_bleach_A$Xtwo)^(1/1)

mod.a2 <- lm(sqtwo ~ int, data = clusts_plus_bleach_A)
summary(mod.a2)
#vif(onelm)
#assess normality
a2.res = residuals(mod.a2)
summary(a2.res)
qqPlot(a2.res)
hist(a2.res)
boxplot(a2.res)
shapiro.test(a2.res)

#assess homoscedasticity
plot(fitted(mod.a2),a2.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a2),a2.res));

Anova(mod.a2,test.statistic = 'F')

suma2 <- glht(mod.a2, linfct=mcp(int ="Tukey"))

suma2t <- table_glht(suma2)

write.csv(suma2t, "tukey_a_two_only.csv")
```


```{r}
clusts_plus_bleach_A$sqthree <- log(1+clusts_plus_bleach_A$Xthree)^(1/1)

mod.a3 <- lm(sqthree ~ int, data = clusts_plus_bleach_A)
summary(mod.a3)
#vif(onelm)
#assess normality
a3.res = residuals(mod.a3)
summary(a3.res)
qqPlot(a3.res)
hist(a3.res)
boxplot(a3.res)
shapiro.test(a3.res)

#assess homoscedasticity
plot(fitted(mod.a3),a3.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a3),a3.res));

Anova(mod.a3,test.statistic = 'F')

suma3 <- glht(mod.a3, linfct=mcp(int ="Tukey"))


suma3t <- table_glht(suma3)

write.csv(suma3t, "tukey_a_three_only.csv")
```



```{r}
clusts_plus_bleach_A$sqthreefour <- log(1+clusts_plus_bleach_A$Xthreefour)^(1/1)

mod.a34 <- lm(sqthreefour ~ int, data = clusts_plus_bleach_A)
summary(mod.a34)
#vif(onelm)
#assess normality
a34.res = residuals(mod.a34)
summary(a34.res)
qqPlot(a34.res)
hist(a34.res)
boxplot(a34.res)
shapiro.test(a34.res)

#assess homoscedasticity
plot(fitted(mod.a34),a34.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a34),a34.res));

Anova(mod.a34,test.statistic = 'F')

suma34 <- glht(mod.a34, linfct=mcp(int ="Tukey"))


sumat34 <- table_glht(suma34)

write.csv(sumat34, "tukey_a_34.csv")
```

```{r}
clusts_plus_bleach_A$sqfour <- log(1+clusts_plus_bleach_A$Xfour)^(1/1)

mod.a4 <- lm(sqfour ~ int, data = clusts_plus_bleach_A)
summary(mod.a4)
#vif(onelm)
#assess normality
a4.res = residuals(mod.a4)
summary(a4.res)
qqPlot(a4.res)
hist(a4.res)
boxplot(a4.res)
shapiro.test(a4.res)

#assess homoscedasticity
plot(fitted(mod.a4),a4.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a4),a4.res));

Anova(mod.a4,test.statistic = 'F')

suma4 <- glht(mod.a4, linfct=mcp(int ="Tukey"))

suma4t <- table_glht(suma4)

write.csv(suma4t, "tukey_a_four_only.csv")
```


```{r}
clusts_plus_bleach_A$sqfive <- log(1+clusts_plus_bleach_A$Xfive)^(1/1)

mod.a5 <- lm(sqfive ~ int, data = clusts_plus_bleach_A)
summary(mod.a5)
#vif(onelm)
#assess normality
a5.res = residuals(mod.a5)
summary(a5.res)
qqPlot(a5.res)
hist(a5.res)
boxplot(a5.res)
shapiro.test(a5.res)

#assess homoscedasticity
plot(fitted(mod.a5),a5.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a5),a5.res));


Anova(mod.a5,test.statistic = 'F')

suma5 <- glht(mod.a5, linfct=mcp(int ="Tukey"))


suma5t <- table_glht(suma5)

write.csv(suma5t, "tukey_a_five_only.csv")
```


```{r}
clusts_plus_bleach_A$sq5to10 <- log(1+clusts_plus_bleach_A$X5to10)^(1/1)

mod.a510 <- lm(sq5to10 ~ int, data = clusts_plus_bleach_A)
summary(mod.a510)
#vif(onelm)
#assess normality
a510.res = residuals(mod.a510)
summary(a510.res)
qqPlot(a510.res)
hist(a510.res)
boxplot(a510.res)
shapiro.test(a510.res)

#assess homoscedasticity
plot(fitted(mod.a510),a510.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a510),a510.res));

Anova(mod.a510,test.statistic = 'F')

suma510 <- glht(mod.a510, linfct=mcp(int ="Tukey"))


sumat510 <- table_glht(suma510)

write.csv(sumat510, "tukey_a_510.csv")
```



```{r}
clusts_plus_bleach_A$sq6to9 <- log(1+clusts_plus_bleach_A$X6to9)^(1/1)

mod.a6 <- lm(sq6to9 ~ int, data = clusts_plus_bleach_A)
summary(mod.a6)
#vif(onelm)
#assess normality
a6.res = residuals(mod.a6)
summary(a6.res)
qqPlot(a6.res)
hist(a6.res)
boxplot(a6.res)
shapiro.test(a6.res)

#assess homoscedasticity
plot(fitted(mod.a6),a6.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a6),a6.res));

Anova(mod.a6,test.statistic = 'F')

suma6 <- glht(mod.a6, linfct=mcp(int ="Tukey"))

suma6t <- table_glht(suma6)

write.csv(suma6t, "tukey_a_6to9_only.csv")
```

```{r}
clusts_plus_bleach_A$sqover15 <- log(1+clusts_plus_bleach_A$Xover15)^(1/1)

mod.a15 <- lm(sqover15 ~ int, data = clusts_plus_bleach_A)
summary(mod.a15)
#vif(onelm)
#assess normality
a15.res = residuals(mod.a15)
summary(a15.res)
qqPlot(a15.res)
hist(a15.res)
boxplot(a15.res)
shapiro.test(a15.res)

#assess homoscedasticity
plot(fitted(mod.a15),a15.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a15),a15.res));


Anova(mod.a15,test.statistic = 'F')

suma15 <- glht(mod.a15, linfct=mcp(int ="Tukey"))

suma15t <- table_glht(suma15)

write.csv(suma15t, "tukey_a_over15_only.csv")
```

```{r}
clusts_plus_bleach_A$sq10to15 <- log(1+clusts_plus_bleach_A$X10to15)^(1/1)

mod.a10 <- lm(sq10to15 ~ int, data = clusts_plus_bleach_A)
summary(mod.a10)
#vif(onelm)
#assess normality
a10.res = residuals(mod.a10)
summary(a10.res)
qqPlot(a10.res)
hist(a10.res)
boxplot(a10.res)
shapiro.test(a10.res)

#assess homoscedasticity
plot(fitted(mod.a10),a10.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.a10),a10.res));

Anova(mod.a10,test.statistic = 'F')

suma10 <- glht(mod.a10, linfct=mcp(int ="Tukey"))

suma10t <- table_glht(suma10)

write.csv(suma10t, "tukey_a_10to15_only.csv")
```



```{r}
clusts_plus_bleach$sqover10 <- log(1+clusts_plus_bleach$Xover10)^(1/1)

mod.aover10 <- lm(sqover10 ~ int, data = subset(clusts_plus_bleach, group == "A"))
summary(mod.aover10)
#vif(onelm)
#assess normality
aover10.res = residuals(mod.aover10)
summary(aover10.res)
qqPlot(aover10.res)
hist(aover10.res)
boxplot(aover10.res)
shapiro.test(aover10.res)

#assess homoscedasticity
plot(fitted(mod.aover10),aover10.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.aover10),aover10.res));

Anova(mod.aover10,test.statistic = 'F')

sumaover10 <- glht(mod.aover10, linfct=mcp(int ="Tukey"))

sumatover10 <- table_glht(sumaover10)

write.csv(sumatover10, "tukey_a_over10.csv")
```




```{r}
clusts_plus_bleach_A$sqhistsum <- log(1+clusts_plus_bleach_A$hist_sum)^(1/1)

mod.histsuma <- lm(sqhistsum~ int, data = clusts_plus_bleach_A)
summary(mod.histsuma)
#vif(onelm)
#assess normality
histsuma.res = residuals(mod.histsuma)
summary(histsuma.res)
qqPlot(histsuma.res)
hist(histsuma.res)
boxplot(histsuma.res)
shapiro.test(histsuma.res)

#assess homoscedasticity
plot(fitted(mod.histsuma),histsuma.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.histsuma),histsuma.res));

Anova(mod.histsuma,test.statistic = 'F')

sumahist <- glht(mod.histsuma, linfct=mcp(int ="Tukey"))

sumathist <- table_glht(sumahist)

write.csv(sumathist, "tukey_a_histsum.csv")
```

```{r}


clusts_plus_bleach_A$sqhistcount <- log(1+clusts_plus_bleach_A$hist_count)^(1/1)

mod.histcounta <- lm(sqhistcount ~ int, data = clusts_plus_bleach_A)
summary(mod.histcounta)
#vif(onelm)
#assess normality
histcounta.res = residuals(mod.histcounta)
summary(histcounta.res)
qqPlot(histcounta.res)
hist(histcounta.res)
boxplot(histcounta.res)
shapiro.test(histcounta.res)

#assess homoscedasticity
plot(fitted(mod.histcounta),histcounta.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.histcounta),histcounta.res));


Anova(mod.histcounta,test.statistic = 'F')

sumahistcount <- glht(mod.histcounta, linfct=mcp(int ="Tukey"))


sumathistcount <- table_glht(sumahistcount)

write.csv(sumathistcount, "tukey_a_histcount.csv")
```



















# D stats

```{r}
clusts_plus_bleach_D$sqone <- log(1+clusts_plus_bleach_D$Xone)^(1/1)

mod.d1 <- lm(sqone ~ int, data = clusts_plus_bleach_D)
summary(mod.d1)
#vif(onelm)
#assess normality
d1.res = residuals(mod.d1)
summary(d1.res)
qqPlot(d1.res)
hist(d1.res)
boxplot(d1.res)
shapiro.test(d1.res)

#assess homoscedasticity
plot(fitted(mod.d1),d1.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d1),d1.res));

Anova(mod.d1,test.statistic = 'F')

sumd1 <- glht(mod.d1, linfct=mcp(int ="Tukey"))

sumd1t <- table_glht(sumd1)

write.csv(sumd1t, "tukey_d_one_only.csv")
```

```{r}
clusts_plus_bleach_D$sqtwo <- log(1+clusts_plus_bleach_D$Xtwo)^(1/1)

mod.d2 <- lm(sqtwo ~ int, data = clusts_plus_bleach_D)
summary(mod.d2)
#vif(onelm)
#assess normality
d2.res = residuals(mod.d2)
summary(d2.res)
qqPlot(d2.res)
hist(d2.res)
boxplot(d2.res)
shapiro.test(d2.res)
#assess homoscedasticity
plot(fitted(mod.d2),d2.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d2),d2.res));

Anova(mod.d2,test.statistic = 'F')

sumd2 <- glht(mod.d2, linfct=mcp(int ="Tukey"))

sumd2t <- table_glht(sumd2)

write.csv(sumd2t, "tukey_d_two_only.csv")
```


```{r}
clusts_plus_bleach_D$sqthree <- log(1+clusts_plus_bleach_D$Xthree)^(1/1)

mod.d3 <- lm(sqthree ~ int, data = clusts_plus_bleach_D)
summary(mod.d3)
#vif(onelm)
#assess normality
d3.res = residuals(mod.d3)
summary(d3.res)
qqPlot(d3.res)
hist(d3.res)
boxplot(d3.res)
shapiro.test(d3.res)

#assess homoscedasticity
plot(fitted(mod.d3),d3.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d3),d3.res));

Anova(mod.d3,test.statistic = 'F')

sumd3 <- glht(mod.d3, linfct=mcp(int ="Tukey"))


sumd3t <- table_glht(sumd3)

write.csv(sumd3t, "tukey_d_three_only.csv")
```

```{r}
clusts_plus_bleach_D$sqthreefour <- log(1+clusts_plus_bleach_D$Xthreefour)^(1/1)

mod.d34 <- lm(sqthreefour ~ int, data = clusts_plus_bleach_D)
summary(mod.d34)
#vif(onelm)
#assess normality
d34.res = residuals(mod.d34)
summary(d34.res)
qqPlot(d34.res)
hist(d34.res)
boxplot(d34.res)
shapiro.test(d34.res)

#assess homoscedasticity
plot(fitted(mod.d34),d34.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d34),d34.res));

Anova(mod.d34,test.statistic = 'F')

sumd34 <- glht(mod.d34, linfct=mcp(int ="Tukey"))

sumdt34 <- table_glht(sumd34)

write.csv(sumdt34, "tukey_d_34.csv")
```


```{r}
clusts_plus_bleach_D$sqfour <- log(1+clusts_plus_bleach_D$Xfour)^(1/1)

mod.d4 <- lm(sqfour ~ int, data = clusts_plus_bleach_D)
summary(mod.d4)
#vif(onelm)
#assess normality
d4.res = residuals(mod.d4)
summary(d4.res)
qqPlot(d4.res)
hist(d4.res)
boxplot(d4.res)
shapiro.test(d4.res)

#assess homoscedasticity
plot(fitted(mod.d4),d4.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d4),d4.res));

Anova(mod.d4,test.statistic = 'F')

sumd4 <- glht(mod.d4, linfct=mcp(int ="Tukey"))


sumd4t <- table_glht(sumd4)

write.csv(sumd4t, "tukey_d_four_only.csv")
```


```{r}
clusts_plus_bleach_D$sqfive <- log(1+clusts_plus_bleach_D$Xfive)^(1/1)

mod.d5 <- lm(sqfive ~ int, data = clusts_plus_bleach_D)
summary(mod.d5)
#vif(onelm)
#assess normality
d5.res = residuals(mod.d5)
summary(d5.res)
qqPlot(d5.res)
hist(d5.res)
boxplot(d5.res)
shapiro.test(d5.res)
#assess homoscedasticity
plot(fitted(mod.d5),d5.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d5),d5.res));

Anova(mod.d5,test.statistic = 'F')

sumd5 <- glht(mod.d5, linfct=mcp(int ="Tukey"))


sumd5t <- table_glht(sumd5)

write.csv(sumd5t, "tukey_d_five_only.csv")
```


```{r}
clusts_plus_bleach_D$sq5to10 <- log(1+clusts_plus_bleach_D$X5to10)^(1/1)

mod.d510 <- lm(sq5to10 ~ int, data = clusts_plus_bleach_D)
summary(mod.d510)
#vif(onelm)
#assess normality
d510.res = residuals(mod.d510)
summary(d510.res)
qqPlot(d510.res)
hist(d510.res)
boxplot(d510.res)
shapiro.test(d510.res)

#assess homoscedasticity
plot(fitted(mod.d510),d510.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d510),d510.res));

Anova(mod.d510,test.statistic = 'F')

sumd510 <- glht(mod.d510, linfct=mcp(int ="Tukey"))

sumdt510 <- table_glht(sumd510)

write.csv(sumdt510, "tukey_d_510.csv")
```



```{r}
clusts_plus_bleach_D$sq6to9 <- log(1+clusts_plus_bleach_D$X6to9)^(1/1)

mod.d6 <- lm(sq6to9 ~ int, data = clusts_plus_bleach_D)
summary(mod.d6)
#vif(onelm)
#assess normality
d6.res = residuals(mod.d6)
summary(d6.res)
qqPlot(d6.res)
hist(d6.res)
boxplot(d6.res)
shapiro.test(d6.res)

#assess homoscedasticity
plot(fitted(mod.d6),d6.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d6),d6.res));

Anova(mod.d6,test.statistic = 'F')

sumd6 <- glht(mod.d6, linfct=mcp(int ="Tukey"))


sumd6t <- table_glht(sumd6)

write.csv(sumd6t, "tukey_d_6to9_only.csv")
```

```{r}
clusts_plus_bleach_D$sqover15 <- log(1+clusts_plus_bleach_D$Xover15)^(1/1)

mod.d15 <- lm(sqover15 ~ int, data = clusts_plus_bleach_D)
summary(mod.d15)
#vif(onelm)
#assess normality
d15.res = residuals(mod.d15)
summary(d15.res)
qqPlot(d15.res)
hist(d15.res)
boxplot(d15.res)
shapiro.test(d15.res)
#assess homoscedasticity
plot(fitted(mod.d15),d15.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d15),d15.res));

Anova(mod.d15,test.statistic = 'F')

sumd15 <- glht(mod.d15, linfct=mcp(int ="Tukey"))


sumd15t <- table_glht(sumd15)

write.csv(sumd15t, "tukey_d_over15_only.csv")
```

```{r}
clusts_plus_bleach_D$sq10to15 <- log(1+clusts_plus_bleach_D$X10to15)^(1/1)

mod.d10 <- lm(sq10to15 ~ int, data = clusts_plus_bleach_D)
summary(mod.d10)
#vif(onelm)
#assess normality
d10.res = residuals(mod.d10)
summary(d10.res)
qqPlot(d10.res)
hist(d10.res)
boxplot(d10.res)
shapiro.test(d10.res)

#assess homoscedasticity
plot(fitted(mod.d10),d10.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.d10),d10.res));

Anova(mod.d10,test.statistic = 'F')

sumd10 <- glht(mod.d10, linfct=mcp(int ="Tukey"))


sumd10t <- table_glht(sumd10)

write.csv(sumd10t, "tukey_d_10to15_only.csv")
```


```{r}
clusts_plus_bleach_D$sqover10 <- log(1+clusts_plus_bleach_D$Xover10)^(1/1)

mod.dover10 <- lm(sqover10 ~ int, data = clusts_plus_bleach_D)
summary(mod.dover10)
#vif(onelm)
#assess normality
dover10.res = residuals(mod.dover10)
summary(dover10.res)
qqPlot(dover10.res)
hist(dover10.res)
boxplot(dover10.res)
shapiro.test(dover10.res)

#assess homoscedasticity
plot(fitted(mod.dover10),dover10.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.dover10),dover10.res));

Anova(mod.dover10,test.statistic = 'F')

sumdover10 <- glht(mod.dover10, linfct=mcp(int ="Tukey"))


sumdtover10 <- table_glht(sumdover10)

write.csv(sumdtover10, "tukey_d_over10.csv")
```


# D cluster sum
```{r}
clusts_plus_bleach_D$sqhistcount <- log(1+clusts_plus_bleach_D$hist_count)^(1/1)

mod.histcountd <- lm(sqhistcount ~ int, data = clusts_plus_bleach_D)
summary(mod.histcountd)
#vif(onelm)
#assess normality
histcountd.res = residuals(mod.histcountd)
summary(histcountd.res)
qqPlot(histcountd.res)
hist(histcountd.res)
boxplot(histcountd.res)
shapiro.test(histcountd.res)

#assess homoscedasticity
plot(fitted(mod.histcountd),histcountd.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.histcountd),histcountd.res));


Anova(mod.histcountd,test.statistic = 'F')

sumdhistcount <- glht(mod.histcountd, linfct=mcp(int ="Tukey"))


sumdthistcount <- table_glht(sumdhistcount)

write.csv(sumdthistcount, "tukey_d_histcount.csv")
```

# D cell sum
```{r}
clusts_plus_bleach_D$sqhistsum <- log(1+clusts_plus_bleach_D$hist_sum)^(1/1)

mod.histsumd <- lm(sqhistsum~ int, data = clusts_plus_bleach_D)
summary(mod.histsumd)
#vif(onelm)
#assess normality
histsumd.res = residuals(mod.histsumd)
summary(histsumd.res)
qqPlot(histsumd.res)
hist(histsumd.res)
boxplot(histsumd.res)
shapiro.test(histsumd.res)

#assess homoscedasticity
plot(fitted(mod.histsumd),histsumd.res);
abline(h=0,lty=2);
lines(smooth.spline(fitted(mod.histsumd),histsumd.res));

Anova(mod.histsumd,test.statistic = 'F')

sumdhist <- glht(mod.histsumd, linfct=mcp(int ="Tukey"))


sumdthist <- table_glht(sumdhist)

write.csv(sumdthist, "tukey_d_histsum.csv")
```